<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>SimTrafk</title>
    <!-- <meta http-equiv="refresh" content="0; url='../v0.5.1/index.html'" /> -->
    <meta name="description" content="Do you think roads are poorly designed?  Do you think you can do better?
        Prove it with this fun HTML5 game!">
    <meta name="author" content="Eric Segerson">
    <meta property="og:title" content="SimTrafk: Fun Online Traffic Game">
    <!--<meta property="og:image" content="social_image.png">-->
    <meta property="og:description" content="Do you think roads are poorly designed?  Do you think you can do better?
        Prove it with this fun HTML5 game!">
	<meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=0.8, user-scalable=0"/> <!--320-->
	<!-- <meta name="apple-mobile-web-app-capable" content="yes" /> -->
    <link href='https://fonts.googleapis.com/css?family=Play' rel="stylesheet">
    <link href="page.css" rel="stylesheet">
    <link href="game.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script src="globals.js"></script>
    <script src="car.js"></script>
    <script src="driver.js"></script>
    <script src="emitter.js"></script>
	<script src="road.js"></script>
    <script src="road1.js"></script><!--data file-->
	<script src="game.js"></script>
    <style>
        .message { transform: rotate(0deg); transition: transform 1s; transform-origin: top right; }
        .message[data-hide] #btnHide { top: -12px; }
        .message #btnHide { transition: top 1s; }
    </style>
    <script>
        jQuery.fn.rotate = function() {
            var degrees = "0";
            if (!$(this).is("[data-hide]")) {
                degrees = "-90"; 
                $(this).attr("data-hide", "");
                $("#btnHide").text("V");
            } else {
                $(this).removeAttr("data-hide");
                $("#btnHide").text("X");
            } 
            $(this).css({'transform': 'rotate(' + degrees + 'deg)'});
            return $(this);
        };
    </script>
</head>
<body>
    <div class="message">
        <h1>Experiment #0.6</h1>
        <p>TODO:</p>
        <style>s { opacity: 0.5; }</style>
        <ol>
            <li><s>Curve road</s></li>
            <li><s>Get drag & drop working again</s></li>
            <li><s>Draw tangent lines in road.render()</s></li>
            <li>Check that new interpolation code works on road-forks</li>
            <li>Check that all code is inside sim
                <ul><li>game.js needs work</li></ul>
            </li>
            <li>Work up better UI for sim control (pause/slow/step/stop, mph/kph, # driving, rate, velo, extra debug info like steering)</li>
            <li>Save settings in cookies</li>
            <li>Make car stop at end of road</li>
            <li>Make car stop if car in front</li>
            <li>Don't emit if no room in front of emitter</li>
            <li>Figure out how to handle unfocused window</li>
        </ol>
        <p>Refactored code; all code is now in a "sim" object.  Cleared out a lot of test code that's no longer useful, and moved other code around into more logical places or scopes.</p>
        <p>Screen layout (rendering) is now more structured and coherent.</p>
        <p>Roads are now curved.  Cars now follow each node along the curve.</p>
        <p>Cars now stop at a dead-end.</p>
        <p>Cars now stop if a car is in front of them.</p>
        <p>Emitter will create a car only when there is room.</p>
        
        <span id="spanAlive"></span>
        <!-- <button id="btnAdd" onclick="add()">Add cars</button> -->
        <button id="btnPause" onclick="pauseSim()">Pause Sim</button>
        <button id="btnSlow" onclick="slowSim()">Slow Sim</button>
        <button id="btnStop" onclick="stopSim()">Stop Sim</button>
		<button id="btnSteering" onclick="toggleSteering()">Show Steering</button>
		<button id="btnHide" onclick="$(this).parent().rotate()" class="close">X</button><br>
		<div>
			Rate: <input id="slRate" type="range" min="0" max="10" value="8" step="1" /><span id="lblSlRate"></span><br>
			Velo: <input id="slVelo" type="range" min="10" max="500" value="100" step="10" /><span id="lblSlVelo"></span>
		</div>
		<div id="debug" style="display: none;"></div>
        <p>Other versions: 
            <a href="../v0.1/index.html">0.1</a>,
            <a href="../v0.2/index.html">0.2</a>,
            <a href="../v0.3/index.html">0.3</a>,
            <a href="../v0.4/index.html">0.4</a>,
            <a href="../v0.5.0/index.html">0.5.0</a>,
            <a href="../v0.5.1/index.html">0.5.1</a>,
            <a href="../v0.5.1/road-test.html">0.5.2</a>,
            <a href="../v0.5.1/interactive.html">0.5.3</a>,
            <a href="../v0.5.1/bezier.html">0.5.4</a>,
            0.6
        </p>
    </div>
    <!--googleoff: all-->
    <noindex class="robots-nocontent">
        <noscript>
            <div>
                <h3>JavaScript is required</h3>
                <h4>You must enable JavaScript on this page to play this game.</h4>
                <p>Don't worry, you're not being tracked!  Read the <a href="privacy.html">privacy policy</a>.</p>
            </div>
        </noscript>
        <div class="nostyle">
            <h3>Styles are required</h3>
            <p>Styles are required for this game to function correctly.  Please enable them.</p>
        </div>
    </noindex>
    <!--googleon: all-->
    <div id="simcontainer">
        <div id="road">
            <svg id="roadBackground" class="buffer"></svg>
            <svg id="roadLines"></svg>
            <svg id="roadNodes"></svg>
            <svg id="roadBeziers"></svg>
        </div>
        <div id="cars">
            <div id="carSVG"></div>
            <div id="carDebugBox"></div>
            <div id="carShoes"></div>
        </div>
        <div id="emitters"></div>
    </div>
</body>
</html>